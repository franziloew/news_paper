!function(){d3.labeler=function(){var t=[],n=[],r=1,a=1,e={},h=0;rej=0;w_orient=3;var o,x,y=!1,i=!1;return energy=function(r){var a=t.length,e=0,h=t[r].x-n[r].x,o=n[r].y-t[r].y,x=Math.sqrt(h*h+o*o),y=!0;theta=0,x>0&&(e+=.2*x),h/=x,o/=x,e+=h>0&&o>0?0*w_orient:h<0&&o>0?1*w_orient:h<0&&o<0?2*w_orient:3*w_orient;for(var i,c,u,M,m,l,g,f=t[r].x,v=t[r].y-t[r].height+2,d=t[r].x+t[r].width,s=t[r].y+2,_=0;_<a;_++)_!=r&&(y=intersect(n[r].x,t[r].x,n[_].x,t[_].x,n[r].y,t[r].y,n[_].y,t[_].y),y&&(e+=1),i=t[_].x,u=t[_].y-t[_].height+2,c=t[_].x+t[_].width,M=t[_].y+2,m=Math.max(0,Math.min(c,d)-Math.max(i,f)),l=Math.max(0,Math.min(M,s)-Math.max(u,v)),g=m*l,e+=30*g),i=n[_].x-n[_].r,u=n[_].y-n[_].r,c=n[_].x+n[_].r,M=n[_].y+n[_].r,m=Math.max(0,Math.min(c,d)-Math.max(i,f)),l=Math.max(0,Math.min(M,s)-Math.max(u,v)),g=m*l,e+=30*g;return e},mcmove=function(e){var x,i=Math.floor(Math.random()*t.length),c=t[i].x,u=t[i].y;x=y?o(i,t,n):energy(i),t[i].x+=5*(Math.random()-.5),t[i].y+=5*(Math.random()-.5),t[i].x>r&&(t[i].x=c),t[i].x<0&&(t[i].x=c),t[i].y>a&&(t[i].y=u),t[i].y<0&&(t[i].y=u);var M;M=y?o(i,t,n):energy(i);var m=M-x;Math.random()<Math.exp(-m/e)?h+=1:(t[i].x=c,t[i].y=u,rej+=1)},mcrotate=function(e){var x,i=Math.floor(Math.random()*t.length),c=t[i].x,u=t[i].y;x=y?o(i,t,n):energy(i);var M=.5*(Math.random()-.5),m=Math.sin(M),l=Math.cos(M);t[i].x-=n[i].x,t[i].y-=n[i].y;var g=t[i].x*l-t[i].y*m,f=t[i].x*m+t[i].y*l;t[i].x=g+n[i].x,t[i].y=f+n[i].y,t[i].x>r&&(t[i].x=c),t[i].x<0&&(t[i].x=c),t[i].y>a&&(t[i].y=u),t[i].y<0&&(t[i].y=u);var v;v=y?o(i,t,n):energy(i);var d=v-x;Math.random()<Math.exp(-d/e)?h+=1:(t[i].x=c,t[i].y=u,rej+=1)},intersect=function(t,n,r,a,e,h,o,x){var y,i,c,u,M;return c=(x-o)*(n-t)-(a-r)*(h-e),u=(a-r)*(e-o)-(x-o)*(t-r),M=(n-t)*(e-o)-(h-e)*(t-r),y=u/c,i=M/c,!(y<0||y>1||i<0||i>1)},cooling_schedule=function(t,n,r){return t-n/r},e.start=function(n){for(var r=t.length,a=1,e=0;e<n;e++){for(var h=0;h<r;h++)Math.random()<.5?mcmove(a):mcrotate(a);a=cooling_schedule(a,1,n)}},e.width=function(t){return arguments.length?(r=t,e):r},e.height=function(t){return arguments.length?(a=t,e):a},e.label=function(n){return arguments.length?(t=n,e):t},e.anchor=function(t){return arguments.length?(n=t,e):n},e.alt_energy=function(t){return arguments.length?(o=t,y=!0,e):energy},e.alt_schedule=function(t){return arguments.length?(x=t,i=!0,e):cooling_schedule},e}}();