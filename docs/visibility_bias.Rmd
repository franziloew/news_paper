---
title: "Visibility Bias"
output: html_document
---

```{r include=FALSE}
knitr::opts_chunk$set(eval=FALSE, include=FALSE)
```

```{r}
rm(list = ls())

library(tidyverse)
library(ggthemes)
source("func/functions.R")

load("../output/data_step2.Rda")

parties <- c("SPD",paste("CDU","CSU","Union",sep = "|"),"FDP","Grüne","AfD","Linke")
```

The visibility of a party or a candidate is important as the visibility of political actors in media coverage will increase their accessibility to audiences, influencing subsequent political judgments. Studies combining media content data with voter surveys have indeed found that voters tend to infer a party's political importance from its media salience.

There is visibility bias in a medium when a political actor is the subject of an undue amount of coverage compared to other actors and other outlets. This type of bias is therefore defined by the relative amount of coverage devoted to each political actor in each medium. Of course, we should not expect all political actors to receive equal amounts of coverage: Some actors will be covered more because of their media viability or because of journalistic news values such as relevance and novelty. However, these factors should influence all media outlets equally, and in this study we focus on relative levels of media bias within one political and media system. Hence, our interest lies in the extent to which some media outlets devote disproportionally more coverage to some actors than other outlets do.

To determine visibility bias, we first need to measure visibility per se. Eberl (2017) treats a party as visible in an article if the party itself or candidates from the party are a speaker or addressee in at least one of the claims included, where a claim is a statement made by an actor about a political issue and/or actor. Similar to that, we treat a party as visible in an article if the party itself is mentioned in an article (if an article contains the word "SPD", "CDU"/"CSU","FDP","Grüne","AfD" or "Linke"). 

The visibility of a party $p$ in a newspaper $s$ is defined as the number of news articles published by the newspaper on that party (e.g. articles that contain the name of the party), normalised on the total amount of articles by that newspaper in the corpus.

$$
\text{visibility}(p,s) = \frac{\text{#Articles}_{p,s}}{\text{#Articles}_s}
$$

```{r claculate total amount of articles by newspaper}
btw <- btw %>% 
  group_by(medium) %>%
  mutate(articles_s = n()) %>%
  ungroup()
```

```{r Function to calculate average visibility for each party}
visibility <- function(data, party) {
     
  data %>% 
    # filter all articles that contain the party as a word
    filter(grepl(party,text, ignore.case = T)) %>%
    # calculate the number of articles by each newspaper
    group_by(medium) %>%
    summarise(
      # pass the total amount of articles to the grouped df
      articles_s = mean(articles_s),
      # calculate the number of articles about a party
      articles_p_s = n(),
      # calculate relative amount
      visibility_p_s = articles_p_s/articles_s) %>%
    mutate(party = party) -> df1
  
}
```

```{r Apply function to all parties}
for (party in parties) {
  partydf <- visibility(btw, party)
  
  if (exists('vis')) {
   vis <- bind_rows(vis, partydf) 
  } else {
    vis <- partydf
  }
}
```

```{r Plot visibility}
vis %>%
  ggplot(aes(medium, visibility_p_s, order = visibility_p_s)) +
  geom_col(fill="#0099c6", alpha=0.8) +
  theme_hc() +
  facet_grid(~party) +
  labs(x = NULL, y = "visibility") +
  coord_flip() +
  theme(axis.text.x = element_text(size = 6),
        axis.title = element_text(size = 7)
        )

ggsave("../figs/visibility.png", width = 7, height = 3)
```

![](../figs/visibility.png)

The next step is to define an appropriate reference point to distinguish between balanced/neutral and biased reporting. In the following analysis the average visibility of all parties in each media outlet during the period of analysis are used as a key benchmark. Visibility bias is then computed as the deviation of each party's specific visibility from the average visibility of all other parties in that outlet. The bias therefore captures whether party visibility is biased in comparison to what is typical for that outlet (Eberl, 2017). 

Alternative approaches to conceptualize the benchmark are the amount of the party campaign communication or their standing in polls (Hopmann et al. (2011b). However, this logic does not allow for comparison across diverse media outlets as some media outlets might generally leave less space to parties or their issues, or be overall more skeptical of them, not due to partisan but rather due to genre or format influences. 

```{r Estimate Bias}
parties <- unique(vis$party)

for (i in parties) {
  
    df1 <- vis %>% 
    filter(party == i) 
  
  df2 <- vis %>%
    filter(party != i) %>%
    group_by(medium) %>%
    summarise(avg_vis = mean(visibility_p_s)) 
  
  tempdf <- left_join(df1,df2, by="medium") %>%
    mutate(visibility_bias = visibility_p_s-avg_vis,
           vis_bias_norm = normalize_data2(visibility_bias))
    
    if (exists('visBias')){
      visBias <- bind_rows(visBias,tempdf)
    } else {
      visBias <- tempdf
    }
}
```

```{r Plot bias}
visBias %>%
  ggplot(aes(medium, vis_bias_norm, label = round(vis_bias_norm, digits = 2))) +
  geom_col(fill="#0099c6", alpha=0.8) +
  theme_hc() +
  geom_text(aes(y = 0), size = 3) +
  facet_grid(~party) +
  labs(x = NULL, y = "visibility bias") +
  coord_flip() +
  scale_y_continuous(breaks = c(-1,0,1), labels = c(-1,0,1)) +
  theme(axis.text.x = element_text(size = 6),
        axis.title = element_text(size = 7)
        )

ggsave("../figs/visibility_bias.png", width = 7, height = 3)
```

![](../figs/visibility_bias.png)
